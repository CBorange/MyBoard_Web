<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <th:block th:fragment="board">
        <link rel="stylesheet" href="/css/board.css">
        <script src="/js/board.js"></script>
        <div class="mx-auto container-lg" style="background-color: #F5F5F5;">
            <!--게시판 레이아웃 Flex 배치-->
            <div class="d-flex flex-column" style="min-height: 800px;">
                <!--게시판 타이틀 상단 여백-->
                <div style="height: 100px;"></div>
                <!--게시판 타이틀 표기-->
                <h2 class="my-5">
                    <span th:text="${boardInfo.getBoardName()}" style="font-weight: bold;"></span>
                </h2>

                <!--게시판 메인 테이블-->
                <table class="table table-hover">
                    <thead>
                    <tr>
                        <th class="text-center table_column_title" scope="col">제목</th>
                        <th class="text-center table_column_writer" scope="col">작성자</th>
                        <th class="text-center table_column_good" scope="col">추천수</th>
                        <th class="text-center table_column_date" scope="col">날짜</th>
                    </tr>
                    </thead>
                    <tbody>
                    <th:block th:each="filteredPost : ${filteredPostList}">
                    <tr>
                        <td class="table_row_title">
                            <a th:href="'/post/' + ${filteredPost.getPostData().getID()}">
                                <span class="title_span" th:text="${filteredPost.getPostData().getTitle()}"></span>
                                <span class="title_commentcount_span"></span>
                            </a>
                        </td>
                        <td><span th:text="${filteredPost.getPostData().getWriterID()}"></span></td>
                        <td><span th:text="${filteredPost.getPostData().getGoodCount()}"></span></td>
                        <td><span th:text="${#temporals.format(filteredPost.getPostData().getCreatedDay(),'yyyy-MM-dd')}"></span></td>
                    </tr>
                    </th:block>
                    </tbody>
                </table>
                <!--게시판 메인 테이블 / 하단 페이지 제어 및 버튼 구분선-->
                <hr/>
                <!--게시글 검색, 글쓰기 버튼-->
                <div class="d-flex flex-row">
                    <!--게시글 검색 Form-->
                    <form action="#" th:action="@{/board/} + ${boardInfo.getID()}" class="d-flex flex-row" style="width: 100%;"
                    id ="boardSearchParamForm">
                        <!--Hidden Input Controller로 부터 전달받는 Parameter들 PageNumber, SortOrderTarget, SortMethod 지정-->
                        <!--신규 검색의 경우 Page 번호는 1로 고정한다.-->
                        <input type="hidden" th:name="pageNumber" th:value="1">
                        <input type="hidden" th:name="sortOrderTarget" th:value="${sortOrderTarget}">
                        <input type="hidden" th:name="sortMethod" th:value="${sortMethod}">

                        <!--최종 전달할 JSON 데이터 input-->
                        <input type="hidden" name="boardSearchParam" id="boardSearchParamInput">

                        <!--게시글 검색 조건 지정 Dropdown List-->
                        <select class="custom-select" th:name="searchMethod">
                            <option selected value="Title">제목</option>
                        </select>

                        <!--게시글 검색 Input-->
                        <input type="search" th:name="searchCondition" style="width: 80%;">

                        <!--검색 실행 Button-->
                        <input type="image" src="/img/search_icon.png" style="width: 30px; height: 30px;">

                    </form>
                    <form class="ms-auto" th:action="@{/writepostform}">
                        <!--글쓰기 Button-->
                        <input type="hidden" th:name="boardID" th:value="${boardInfo.getID()}">
                        <input class="ms-auto btn btn-info" type="submit" value="글쓰기">
                    </form>
                </div>
                <!--조회 기능 영역 <-> Pagination 분리 여백-->
                <div style="height: 20px;"></div>
                <!--하단 페이지 제어 버튼-->
                <div class="d-flex justify-content-center mt-auto">
                    <nav aria-label="Page navigation example">
                        <ul class="pagination">
                            <!--이전 페이지로 이동 버튼, 현재 페이지가 1이 아닌 경우에만 표시-->
                            <th:block th:unless="${curPageNo == 1}">
                                <li class="page-item">
                                    <a class="page-link" th:href="'/board/' + ${boardInfo.getID()} + '?&pageNumber=' + ${curPageNo - 1} +
                                    '&searchMethod=' + ${searchMethod} + '&searchCondition=' + ${searchCondition} +
                                    '&sortOrderTarget=' + ${sortOrderTarget} + '&sortMethod=' + ${sortMethod}"
                                    >
                                        <span><</span>
                                    </a>
                                </li>
                            </th:block>
                            <!--페이지 번호 버튼-->
                            <th:block th:each="pageNo : ${#numbers.sequence(startPageNoInCurSession, endPageNoInCurSession)}">
                                    <th:block th:if="${pageNo == curPageNo}">
                                        <li class="page-item active">
                                            <a class="page-link" th:href="'/board/' + ${boardInfo.getID()} + '?&pageNumber=' + ${pageNo} +
                                            '&searchMethod=' + ${searchMethod} + '&searchCondition=' + ${searchCondition} +
                                            '&sortOrderTarget=' + ${sortOrderTarget} + '&sortMethod=' + ${sortMethod}"
                                            >
                                                <span th:text="${pageNo}"></span>
                                            </a>
                                        </li>
                                    </th:block>
                                    <th:block th:unless="${pageNo == curPageNo}">
                                        <li class="page-item">
                                            <a class="page-link" th:href="'/board/' + ${boardInfo.getID()} + '?&pageNumber=' + ${pageNo} +
                                            '&searchMethod=' + ${searchMethod} + '&searchCondition=' + ${searchCondition} +
                                            '&sortOrderTarget=' + ${sortOrderTarget} + '&sortMethod=' + ${sortMethod}"
                                            >
                                                <span th:text="${pageNo}"></span>
                                            </a>
                                        </li>
                                    </th:block>
                            </th:block>
                            <!--다음 페이지로 이동 버튼, 현재 페이지번호가 페이지 개수 와 같지 않은 경우에만 표시-->
                            <th:block th:unless="${curPageNo == pageCount}">
                                <li class="page-item">
                                    <a class="page-link" th:href="'/board/' + ${boardInfo.getID()} + '?&pageNumber=' + ${curPageNo + 1} +
                                    '&searchMethod=' + ${searchMethod} + '&searchCondition=' + ${searchCondition} +
                                    '&sortOrderTarget=' + ${sortOrderTarget} + '&sortMethod=' + ${sortMethod}">
                                        <span>></span>
                                    </a>
                                </li>
                            </th:block>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </th:block>
</html>
